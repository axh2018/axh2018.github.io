<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="shell脚本基础, cherry">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>shell脚本基础 | cherry</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.2.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>



   <style>
    body{
       background-image: url(https://matery.oss-cn-hangzhou.aliyuncs.com/pic/banner/background.jpg);
       background-repeat:no-repeat;
       background-size:cover;
       background-attachment:fixed;
    }
</style>



<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">cherry</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">cherry</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/axh2018" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Follow Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/axh2018" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Follow Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('https://matery.oss-cn-hangzhou.aliyuncs.com/pic/featureImages/8.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">shell脚本基础</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Shell/">
                                <span class="chip bg-color">Shell</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Linux/" class="post-category">
                                Linux
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-08-16
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    9.2k
                </div>
                

                

                
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="01-Shell脚本学习–入门"><a href="#01-Shell脚本学习–入门" class="headerlink" title="01- Shell脚本学习–入门"></a>01- Shell脚本学习–入门</h2><p><strong>注：本文代码块中有大括号的地方都加了反引号，不加反引号hexo渲染会报错，请注意识别！</strong></p>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><blockquote>
<p>Shell是一种脚本语言，那么，就必须有解释器来执行这些脚本。</p>
</blockquote>
<p>Unix/Linux上常见的Shell脚本解释器有bash、sh、csh、ksh等，习惯上把它们称作一种Shell。我们常说有多少种Shell，其实说的是Shell脚本解释器。</p>
<h3 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h3><p>打开文本编辑器，新建一个文件<code>test.sh</code>，扩展名为<code>.sh</code>（sh代表shell）。</p>
<p>输入一些代码：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token keyword">echo</span> <span class="token string">"Hello World !"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>在命令行运行：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">chmod</span> +x test.sh
./test.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>运行结果：</p>
<pre class="line-numbers language-txt"><code class="language-txt">Hello World !<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>#!</code> 是一个约定的标记，它告诉系统这个脚本需要什么解释器来执行，即<strong>使用哪一种Shell</strong>。<code>echo</code>命令用于向窗口输出文本。</p>
<h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><p>以<code>#</code>开头的行就是注释，会被解释器忽略。sh里没有多行注释，只能每一行加一个#号。</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># --------</span>
<span class="token comment" spellcheck="true"># 这是注释块</span>
<span class="token comment" spellcheck="true"># --------</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="打印输出"><a href="#打印输出" class="headerlink" title="打印输出"></a>打印输出</h3><p><strong>echo</strong>： 是Shell的一个内部指令，用于在屏幕上打印出指定的字符串。</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token keyword">echo</span> arg 
<span class="token keyword">echo</span> -e arg <span class="token comment" spellcheck="true">#执行arg里的转义字符。echo加了-e默认会换行</span>
<span class="token keyword">echo</span> arg <span class="token operator">></span> myfile <span class="token comment" spellcheck="true">#显示结果重定向至文件，会生成myfile文件</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>注意，echo后单引号和双引号作用是不同的。单引号不能转义里面的字符。双引号可有可无，单引号主要用在原样输出中。</p>
<p><strong>printf</strong>：格式化输出语句。<br><code>printf</code> 命令用于格式化输出， 是<code>echo</code>命令的增强版。它是C语言<code>printf()</code>库函数的一个有限的变形，并且在语法上有些不同。</p>
<p>如同 <code>echo</code> 命令，<code>printf</code> 命令也可以输出简单的字符串:</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">printf</span> <span class="token string">"hello\n"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>printf</code> 不像 <code>echo</code> 那样会自动换行，必须显式添加换行符(\n)。</p>
<p>注意：<code>printf</code> 由 POSIX 标准所定义，移植性要比 <code>echo</code> 好。</p>
<p>printf 命令的语法：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">printf</span>  format-string  <span class="token punctuation">[</span>arguments<span class="token punctuation">..</span>.<span class="token punctuation">]</span>

<span class="token comment" spellcheck="true">#format-string 为格式控制字符串，arguments 为参数列表。功能和用法与c语言的 printf 命令类似。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>这里仅说明与C语言printf()函数的不同：</p>
<ul>
<li>printf 命令不用加括号</li>
<li>format-string 可以没有引号，但最好加上，单引号双引号均可。</li>
<li>参数比格式控制符(%)多时，格式控制符可以重用，可以将所有参数都转换。</li>
<li>arguments 使用空格分隔，不用逗号。</li>
</ul>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 双引号</span>
<span class="token function">printf</span> <span class="token string">"%d %s\n"</span> 10 <span class="token string">"abc"</span>
10 abc
<span class="token comment" spellcheck="true"># 单引号与双引号效果一样 </span>
<span class="token function">printf</span> <span class="token string">'%d %s\n'</span> 10 <span class="token string">"abc"</span> 
10 abc

<span class="token comment" spellcheck="true"># 没有引号也可以输出</span>
<span class="token function">printf</span> %s abc
abc

<span class="token comment" spellcheck="true"># 但是下面的会出错：</span>
<span class="token function">printf</span> %d %s 10 abc 
<span class="token comment" spellcheck="true">#因为系统分不清楚哪个是参数，这时候最好加引号了。</span>


<span class="token comment" spellcheck="true"># 格式只指定了一个参数，但多出的参数仍然会按照该格式输出，format-string 被重用</span>
$ <span class="token function">printf</span> %s a b c
abc
$ <span class="token function">printf</span> <span class="token string">"%s\n"</span> a b c
a
b
c

<span class="token comment" spellcheck="true"># 如果没有 arguments，那么 %s 用NULL代替，%d 用 0 代替</span>
$ <span class="token function">printf</span> <span class="token string">"%s and %d \n"</span> 
and 0

<span class="token comment" spellcheck="true"># 如果以 %d 的格式来显示字符串，那么会有警告，提示无效的数字，此时默认置为 0</span>
$ <span class="token function">printf</span> <span class="token string">"The first program always prints'%s,%d\n'"</span> Hello Shell
-bash: printf: Shell: invalid number
The first program always prints <span class="token string">'Hello,0'</span>
$<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>read</strong>： 命令行从输入设备读入内容</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token comment" spellcheck="true"># Author : lalal</span>

<span class="token keyword">echo</span> <span class="token string">"What is your name?"</span>
<span class="token function">read</span> NAME <span class="token comment" spellcheck="true">#输入</span>
<span class="token keyword">echo</span> <span class="token string">"Hello, <span class="token variable">$NAME</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>运行脚本：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">chmod</span> +x test.sh
./test.sh

What is your name?
lalal

Hello, lalal<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="变量定义"><a href="#变量定义" class="headerlink" title="变量定义"></a>变量定义</h3><p>Shell支持自定义变量。</p>
<h3 id="定义变量"><a href="#定义变量" class="headerlink" title="定义变量"></a>定义变量</h3><p>定义变量时，变量名不加美元符号（$），如：</p>
<pre class="line-numbers language-bash"><code class="language-bash">variableName<span class="token operator">=</span><span class="token string">"value"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>注意，<strong>变量名和等号之间不能有空格</strong>，这可能和你熟悉的所有编程语言都不一样。有空格会出错。</p>
<p>同时，变量名的命名须遵循如下规则：</p>
<blockquote>
<ul>
<li>首个字符必须为字母（a-z，A-Z）。</li>
</ul>
</blockquote>
<ul>
<li>中间不能有空格，可以使用下划线（_）。</li>
<li>不能使用标点符号。</li>
<li>不能使用bash里的关键字（可用help命令查看保留关键字）。</li>
</ul>
<p>变量定义举例：</p>
<pre class="line-numbers language-bash"><code class="language-bash">myUrl<span class="token operator">=</span><span class="token string">"lalal"</span>
myNum<span class="token operator">=</span>100<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<blockquote>
<p>注意：变量中间不能有空格，如果手误写错(例如 <code>var = test</code>)，刚好要使用<code>rm -rf $var/</code>删除这个目录，实际删除的是<code>/</code>！</p>
</blockquote>
<h3 id="使用变量"><a href="#使用变量" class="headerlink" title="使用变量"></a>使用变量</h3><p>使用一个定义过的变量，只要在变量名前面加美元符号（$）即可，如：</p>
<pre class="line-numbers language-bash"><code class="language-bash">your_name<span class="token operator">=</span><span class="token string">"lalal"</span>
<span class="token keyword">echo</span> <span class="token variable">$your_name</span>
<span class="token keyword">echo</span> $<span class="token variable"><span class="token variable">`</span><span class="token punctuation">{</span>your_name<span class="token punctuation">}</span><span class="token variable">`</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><strong>变量名外面的花括号是可选的</strong>，加不加都行，加花括号是为了帮助解释器识别变量的边界，比如下面这种情况：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token keyword">for</span> skill <span class="token keyword">in</span> C PHP Python Java 
<span class="token keyword">do</span>
    <span class="token keyword">echo</span> <span class="token string">"I am good at $<span class="token variable"><span class="token variable">`</span><span class="token punctuation">{</span>skill<span class="token punctuation">}</span><span class="token variable">`</span></span>Script"</span>
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>如果不给skill变量加花括号，写成<code>echo "I am good at $skillScript"</code>，解释器就会把<code>$skillScript</code>当成一个变量（其值为空），代码执行结果就不是我们期望的样子了。</p>
<p><strong>推荐给所有变量加上花括号，这是个好的编程习惯。</strong></p>
<blockquote>
<p>已定义的变量，可以被重新定义。</p>
</blockquote>
<p>在变量前面加<code>readonly</code> 命令可以将变量定义为只读变量，只读变量的值不能被改变。</p>
<pre class="line-numbers language-bash"><code class="language-bash">url<span class="token operator">=</span><span class="token string">"http://www.baidu.com"</span>
<span class="token function">readonly</span> url
url<span class="token operator">=</span><span class="token string">"http://www.baidu.com"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>使用 <code>unset</code> 命令可以删除变量。语法：</p>
<pre class="line-numbers language-bash"><code class="language-bash">unset variable_name<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>变量被删除后不能再次使用；unset 命令不能删除只读变量。</p>
<h3 id="变量类型"><a href="#变量类型" class="headerlink" title="变量类型"></a>变量类型</h3><p>运行shell时，会同时存在三种变量：<br><strong>1) 局部变量</strong><br>局部变量在脚本或命令中定义，仅在当前shell实例中有效，其他shell启动的程序不能访问局部变量。</p>
<p><strong>2) 环境变量</strong><br>所有的程序，包括shell启动的程序，都能访问环境变量，有些程序需要环境变量来保证其正常运行。必要的时候shell脚本也可以定义环境变量。</p>
<p><strong>3) shell变量</strong><br>shell变量是由shell程序设置的特殊变量。shell变量中有一部分是环境变量，有一部分是局部变量，这些变量保证了shell的正常运行。</p>
<h3 id="特殊变量"><a href="#特殊变量" class="headerlink" title="特殊变量"></a>特殊变量</h3><p>前面已经讲到，<strong>变量名只能包含数字、字母和下划线</strong>，因为某些包含其他字符的变量有特殊含义，这样的变量被称为<strong>特殊变量</strong>。</p>
<table>
<thead>
<tr>
<th>变量</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>$0</code></td>
<td>当前脚本的文件名</td>
</tr>
<tr>
<td><code>$n</code></td>
<td>传递给脚本或函数的参数。n 是一个数字，表示第几个参数。例如，第一个参数是<code>$1</code>，第二个参数是<code>$2</code>。</td>
</tr>
<tr>
<td><code>$#</code></td>
<td>传递给脚本或函数的参数个数。</td>
</tr>
<tr>
<td><code>$*</code></td>
<td>传递给脚本或函数的所有参数。</td>
</tr>
<tr>
<td><code>$@</code></td>
<td>传递给脚本或函数的所有参数。被双引号(“ “)包含时，与 <code>$*</code> 稍有不同</td>
</tr>
<tr>
<td><code>$?</code></td>
<td>上个命令的退出状态，或函数的返回值。</td>
</tr>
<tr>
<td><code>$$</code></td>
<td>当前Shell进程ID。对于 Shell 脚本，就是这些脚本所在的进程ID。</td>
</tr>
</tbody></table>
<p>示例：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token keyword">echo</span> <span class="token string">"File Name: <span class="token variable">$0</span>"</span>
<span class="token keyword">echo</span> <span class="token string">"First Parameter : <span class="token variable">$1</span>"</span>
<span class="token keyword">echo</span> <span class="token string">"Second Parameter : <span class="token variable">$2</span>"</span>
<span class="token keyword">echo</span> <span class="token string">"Quoted Values: <span class="token variable">$@</span>"</span>
<span class="token keyword">echo</span> <span class="token string">"Quoted Values: <span class="token variable">$*</span>"</span>
<span class="token keyword">echo</span> <span class="token string">"Total Number of Parameters : <span class="token variable">$#</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>运行结果：</p>
<pre class="line-numbers language-bash"><code class="language-bash">$./test.sh Zara Ali
File Name <span class="token keyword">:</span> ./test.sh
First Parameter <span class="token keyword">:</span> Zara
Second Parameter <span class="token keyword">:</span> Ali
Quoted Values: Zara Ali
Quoted Values: Zara Ali
Total Number of Parameters <span class="token keyword">:</span> 2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="和-的区别"><a href="#和-的区别" class="headerlink" title="$* 和 $@ 的区别"></a><code>$*</code> 和 <code>$@</code> 的区别</h3><p><code>$*</code> 和 <code>$@</code> 都表示传递给函数或脚本的所有参数，不被双引号(“ “)包含时，都以<code>"$1" "$2" … "$n"</code> 的形式输出所有参数。</p>
<p>但是当它们被双引号(“ “)包含时，”<code>$*</code>“ 会将所有的参数作为一个整体，以”<code>$1 $2 … $n</code>“的形式输出所有参数；”<code>$@</code>“ 会将各个参数分开，以<code>"$1" "$2" … "$n"</code> 的形式输出所有参数。</p>
<p>示例：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token keyword">echo</span> <span class="token string">"\<span class="token variable">$*</span>="</span> <span class="token variable">$*</span>
<span class="token keyword">echo</span> <span class="token string">"\"\<span class="token variable">$*</span>\"="</span> <span class="token string">"<span class="token variable">$*</span>"</span>
<span class="token keyword">echo</span> <span class="token string">"\<span class="token variable">$@</span>="</span> <span class="token variable">$@</span>
<span class="token keyword">echo</span> <span class="token string">"\"\<span class="token variable">$@</span>\"="</span> <span class="token string">"<span class="token variable">$@</span>"</span>
<span class="token keyword">echo</span> <span class="token string">"print each param from \<span class="token variable">$*</span>"</span>
<span class="token keyword">for</span> var <span class="token keyword">in</span> <span class="token variable">$*</span>
<span class="token keyword">do</span>
    <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$var</span>"</span>
<span class="token keyword">done</span>
<span class="token keyword">echo</span> <span class="token string">"print each param from \<span class="token variable">$@</span>"</span>
<span class="token keyword">for</span> var <span class="token keyword">in</span> <span class="token variable">$@</span>
<span class="token keyword">do</span>
    <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$var</span>"</span>
<span class="token keyword">done</span>
<span class="token keyword">echo</span> <span class="token string">"print each param from \"\<span class="token variable">$*</span>\""</span>
<span class="token keyword">for</span> var <span class="token keyword">in</span> <span class="token string">"<span class="token variable">$*</span>"</span>
<span class="token keyword">do</span>
    <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$var</span>"</span>
<span class="token keyword">done</span>
<span class="token keyword">echo</span> <span class="token string">"print each param from \"\<span class="token variable">$@</span>\""</span>
<span class="token keyword">for</span> var <span class="token keyword">in</span> <span class="token string">"<span class="token variable">$@</span>"</span>
<span class="token keyword">do</span>
    <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$var</span>"</span>
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>执行 <code>./test.sh "a" "b" "c" "d"</code>，看到下面的结果：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token variable">$*</span><span class="token operator">=</span>  a b c d
<span class="token string">"<span class="token variable">$*</span>"</span><span class="token operator">=</span> a b c d
<span class="token variable">$@</span><span class="token operator">=</span>  a b c d
<span class="token string">"<span class="token variable">$@</span>"</span><span class="token operator">=</span> a b c d
print each param from <span class="token variable">$*</span>
a
b
c
d
print each param from <span class="token variable">$@</span>
a
b
c
d
print each param from <span class="token string">"<span class="token variable">$*</span>"</span>
a b c d
print each param from <span class="token string">"<span class="token variable">$@</span>"</span>
a
b
c
d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="退出状态"><a href="#退出状态" class="headerlink" title="退出状态"></a>退出状态</h3><p><code>$?</code> 可以获取上一个命令的退出状态。所谓退出状态，就是上一个命令执行后的返回结果。</p>
<p>示例：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token operator">!=</span> 0 <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
  <span class="token keyword">echo</span> <span class="token string">"error"</span>
  <span class="token keyword">exit</span> 1<span class="token punctuation">;</span>
<span class="token keyword">fi</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>退出状态是一个数字，一般情况下，大部分命令执行成功会返回 0，失败返回 1。</p>
<p>不过，也有一些命令返回其他值，表示不同类型的错误。</p>
<h3 id="转义字符"><a href="#转义字符" class="headerlink" title="转义字符"></a>转义字符</h3><pre class="line-numbers language-bash"><code class="language-bash">转义字符    含义
\\    反斜杠
\a    警报，响铃
\b    退格（删除键）
\f    换页<span class="token punctuation">(</span>FF<span class="token punctuation">)</span>，将当前位置移到下页开头
\n    换行
\r    回车
\t    水平制表符（tab键） 
\v    垂直制表符<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>shell默认是不转义上面的字符的。需要加<code>-e</code>选项。</strong></p>
<p>举个例子：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
a<span class="token operator">=</span>11
<span class="token keyword">echo</span> -e <span class="token string">"a is <span class="token variable">$a</span> \n"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>运行结果：</p>
<pre class="line-numbers language-bash"><code class="language-bash">a is 11<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>这里 <code>-e</code> 表示对转义字符进行替换。如果不使用 <code>-e</code> 选项，将会原样输出：</p>
<pre class="line-numbers language-bash"><code class="language-bash">a is 11\n<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>可以使用 echo 命令的 <code>-E</code> 选项禁止转义，默认也是不转义的；使用 <code>-n</code> 选项可以禁止插入换行符。</p>
<h3 id="命令替换"><a href="#命令替换" class="headerlink" title="命令替换"></a>命令替换</h3><p>命令替换是指Shell可以先执行命令，将输出结果暂时保存，在适当的地方输出。</p>
<p>语法：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token variable"><span class="token variable">`</span><span class="token function">command</span><span class="token variable">`</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><strong>注意是反引号，不是单引号，这个键位于 Esc 键下方。</strong></p>
<p>下面的例子中，将命令执行结果保存在变量中：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
DATE<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">date</span><span class="token variable">`</span></span>
<span class="token keyword">echo</span> <span class="token string">"Date is <span class="token variable">$DATE</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="变量替换"><a href="#变量替换" class="headerlink" title="变量替换"></a>变量替换</h3><p>变量替换可以根据变量的状态（是否为空、是否定义等）来改变它的值。</p>
<p>可以使用的变量替换形式：</p>
<table>
<thead>
<tr>
<th>形式</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>$<code>{var}</code></td>
<td>变量本来的值</td>
</tr>
<tr>
<td>$<code>{var:-word}</code></td>
<td>如果变量 <code>var</code> 为空或已被删除(unset)，那么返回 word，但不改变 <code>var</code> 的值。</td>
</tr>
<tr>
<td>$<code>{var:=word}</code></td>
<td>如果变量 <code>var</code> 为空或已被删除(unset)，那么返回 word，并将 <code>var</code> 的值设置为 word。</td>
</tr>
<tr>
<td>$<code>{var:?message}</code></td>
<td>如果变量 <code>var</code> 为空或已被删除(unset)，那么将消息 message 送到标准错误输出，可以用来检测变量 <code>var</code> 是否可以被正常赋值。若此替换出现在Shell脚本中，那么脚本将停止运行。</td>
</tr>
<tr>
<td>$<code>{var:+word}</code></td>
<td>如果变量 <code>var</code> 被定义，那么返回 word，但不改变 var 的值。</td>
</tr>
</tbody></table>
<h3 id="一个完整的shell示例"><a href="#一个完整的shell示例" class="headerlink" title="一个完整的shell示例"></a>一个完整的shell示例</h3><p>下面的脚本用于php安装过程中安装zip扩展。</p>
<p><code>php_zip_ins.sh</code></p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token comment" spellcheck="true">#zip install</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> -d php-5.4.25/ext/zip <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
    <span class="token function">cd</span> php-5.4.25/ext/zip
<span class="token keyword">else</span>
    <span class="token function">tar</span> zxvf php-5.4.25.tar.gz
    <span class="token function">cd</span> php-5.4.25/ext/zip
<span class="token keyword">fi</span>
/usr/local/php/bin/phpize
./configure --with-php-config<span class="token operator">=</span>/usr/local/php/bin/php-config
<span class="token function">make</span>
<span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token operator">!=</span> 0 <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">exit</span>
<span class="token function">make</span> <span class="token function">install</span>
<span class="token keyword">echo</span> 
<span class="token function">grep</span> <span class="token string">'no-debug-zts-20100525'</span> /usr/local/php/etc/php.ini
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token operator">!=</span> 0 <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        <span class="token keyword">echo</span> <span class="token string">''</span> <span class="token operator">>></span> /usr/local/php/etc/php.ini
        <span class="token keyword">echo</span> <span class="token string">'extension_dir=/usr/local/php/lib/php/extensions/no-debug-zts-20100525'</span> <span class="token operator">>></span> /usr/local/php/etc/php.ini
<span class="token keyword">fi</span>
<span class="token function">grep</span> <span class="token string">'zip.so'</span> /usr/local/php/etc/php.ini
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token operator">!=</span> 0 <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
    <span class="token keyword">echo</span> <span class="token string">'extension=zip.so'</span> <span class="token operator">>></span> /usr/local/php/etc/php.ini
<span class="token keyword">fi</span>
<span class="token keyword">echo</span> <span class="token string">"zip install is OK"</span>


/usr/local/apache2/bin/apachectl restart
<span class="token function">cd</span> -
<span class="token function">rm</span> -rf php-5.4.25
<span class="token keyword">echo</span> <span class="token string">"all ok!"</span>
<span class="token function">ls</span> /usr/local/php/lib/php/extensions/no-debug-zts-20100525/
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="02-Shell脚本学习–运算符"><a href="#02-Shell脚本学习–运算符" class="headerlink" title="02- Shell脚本学习–运算符"></a>02- Shell脚本学习–运算符</h2><h3 id="Shell运算符"><a href="#Shell运算符" class="headerlink" title="Shell运算符"></a>Shell运算符</h3><p>Bash 支持很多运算符，包括算数运算符、关系运算符、布尔运算符、字符串运算符和文件测试运算符。</p>
<h3 id="算术运算符"><a href="#算术运算符" class="headerlink" title="算术运算符"></a>算术运算符</h3><p>原生bash不支持简单的数学运算，但是可以通过其他命令来实现，例如 awk 和 expr，expr 最常用。</p>
<p><code>expr</code> 是一款表达式计算工具，使用它能完成表达式的求值操作。</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 命令行直接计算</span>
<span class="token function">expr</span> 2 + 2   <span class="token comment" spellcheck="true">#4</span>
<span class="token function">expr</span> 3 - 2   <span class="token comment" spellcheck="true">#1</span>
<span class="token function">expr</span> 3 / 2   <span class="token comment" spellcheck="true">#1</span>
<span class="token function">expr</span> 3 \* 2   <span class="token comment" spellcheck="true">#6</span>

<span class="token comment" spellcheck="true"># 使用表达式</span>
a<span class="token operator">=</span>10
b<span class="token operator">=</span>20
val<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $a + $b<span class="token variable">`</span></span>
<span class="token keyword">echo</span> <span class="token string">"a + b : <span class="token variable">$val</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>注意：</p>
<ul>
<li><strong>表达式和运算符之间要有空格</strong>，例如 <code>2+2</code> 是不对的，必须写成 <code>2 + 2</code>，这与我们熟悉的大多数编程语言不一样。</li>
<li>乘号(*)前边必须加反斜杠(\)才能实现乘法运算</li>
<li>完整的表达式要被 ` ` 包含，注意这个字符不是常用的单引号，在 Esc 键下边。</li>
</ul>
<p><strong>算术运算符列表</strong></p>
<pre class="line-numbers language-bash"><code class="language-bash">运算符    说明        举例
+        加法    <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $a + $b<span class="token variable">`</span></span> 结果为 30。
-       减法    <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $a - $b<span class="token variable">`</span></span> 结果为 10。
*        乘法    <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $a \* $b<span class="token variable">`</span></span> 结果为  200。
/        除法    <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $b / $a<span class="token variable">`</span></span> 结果为 2。
%        取余    <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $b % $a<span class="token variable">`</span></span> 结果为 0。
<span class="token operator">=</span>        赋值    a<span class="token operator">=</span><span class="token variable">$b</span> 将把变量 b 的值赋给 a。
<span class="token operator">==</span>        相等。用于比较两个数字，相同则返回 true。    <span class="token punctuation">[</span> <span class="token variable">$a</span> <span class="token operator">==</span> <span class="token variable">$b</span> <span class="token punctuation">]</span> 返回 false。
<span class="token operator">!=</span>        不相等。用于比较两个数字，不相同则返回 true。    <span class="token punctuation">[</span> <span class="token variable">$a</span> <span class="token operator">!=</span> <span class="token variable">$b</span> <span class="token punctuation">]</span> 返回 true。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="关系运算符"><a href="#关系运算符" class="headerlink" title="关系运算符"></a>关系运算符</h3><p>关系运算符只支持数字，不支持字符串，除非字符串的值是数字。</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/sh</span>
a<span class="token operator">=</span>10
b<span class="token operator">=</span>20
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$a</span> -eq <span class="token variable">$b</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
   <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$a</span> -eq <span class="token variable">$b</span> : a is equal to b"</span>
<span class="token keyword">else</span>
   <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$a</span> -eq <span class="token variable">$b</span>: a is not equal to b"</span>
<span class="token keyword">fi</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>缩成一行可以这样：</p>
<pre class="line-numbers language-bash"><code class="language-bash">a<span class="token operator">=</span>10<span class="token punctuation">;</span>b<span class="token operator">=</span>20<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$a</span> -eq <span class="token variable">$b</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span> <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$a</span> -eq <span class="token variable">$b</span> : a is equal to b"</span><span class="token punctuation">;</span> <span class="token keyword">else</span> <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$a</span> -eq <span class="token variable">$b</span>: a is not equal to b"</span><span class="token punctuation">;</span> <span class="token keyword">fi</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>这里缩写，主要是为了让大家注意：</p>
<ul>
<li>if后面直到then前面的分号结束，都是有空格的: <code>if [ $a -eq $b ]</code></li>
</ul>
<p><strong>关系运算符列表</strong></p>
<pre class="line-numbers language-bash"><code class="language-bash">运算符    说明
-eq    检测两个数是否相等，相等返回 true。同算数运算符<span class="token variable"><span class="token variable">`</span><span class="token operator">==</span><span class="token variable">`</span></span>
-ne    检测两个数是否相等，不相等返回 <span class="token boolean">true</span>
-gt    检测左边的数是否大于右边的，如果是，则返回 true。
-lt    检测左边的数是否小于右边的，如果是，则返回 true。
-ge    检测左边的数是否大等于右边的，如果是，则返回 true。
-le    检测左边的数是否小于等于右边的，如果是，则返回 true。
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="布尔运算符"><a href="#布尔运算符" class="headerlink" title="布尔运算符"></a>布尔运算符</h3><p><strong>布尔运算符列表</strong></p>
<pre class="line-numbers language-bash"><code class="language-bash">运算符    说明
<span class="token operator">!</span>    非运算，表达式为 <span class="token boolean">true</span> 则返回 false，否则返回 true。
-o    或运算<span class="token punctuation">(</span>or<span class="token punctuation">)</span>，有一个表达式为 <span class="token boolean">true</span> 则返回 true。
-a    与运算<span class="token punctuation">(</span>and<span class="token punctuation">)</span>，两个表达式都为 <span class="token boolean">true</span> 才返回 true。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token keyword">if</span> <span class="token punctuation">[</span> 3 -eq 3 -a 3 -lt 5 <span class="token punctuation">]</span>
<span class="token keyword">then</span>
    <span class="token keyword">echo</span> <span class="token string">'ok'</span>
<span class="token keyword">fi</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="字符串运算符"><a href="#字符串运算符" class="headerlink" title="字符串运算符"></a>字符串运算符</h3><p><strong>字符串运算符列表</strong></p>
<pre class="line-numbers language-bash"><code class="language-bash">运算符    说明    举例
<span class="token operator">=</span>    检测两个字符串是否相等，相等返回 true。    <span class="token punctuation">[</span> <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$b</span> <span class="token punctuation">]</span> 返回 false。
<span class="token operator">!=</span>    检测两个字符串是否相等，不相等返回 true。    <span class="token punctuation">[</span> <span class="token variable">$a</span> <span class="token operator">!=</span> <span class="token variable">$b</span> <span class="token punctuation">]</span> 返回 true。
-z    检测字符串长度是否为0，为0返回 true。    <span class="token punctuation">[</span> -z <span class="token variable">$a</span> <span class="token punctuation">]</span> 返回 false。
-n    检测字符串长度是否为0，不为0返回 true。    <span class="token punctuation">[</span> -n <span class="token variable">$a</span> <span class="token punctuation">]</span> 返回 true。
str    检测字符串是否为空，不为空返回 true。    <span class="token punctuation">[</span> <span class="token variable">$a</span> <span class="token punctuation">]</span> 返回 true。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="文件测试运算符"><a href="#文件测试运算符" class="headerlink" title="文件测试运算符"></a>文件测试运算符</h3><p>文件测试运算符用于检测 Unix 文件的各种属性。</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/sh</span>
file<span class="token operator">=</span><span class="token string">"/tmp/test.sh"</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> -e <span class="token variable">$file</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
   <span class="token keyword">echo</span> <span class="token string">"File exists"</span>
<span class="token keyword">else</span>
   <span class="token keyword">echo</span> <span class="token string">"File does not exist"</span>
<span class="token keyword">fi</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>文件测试运算符列表</p>
<pre class="line-numbers language-bash"><code class="language-bash">操作符    说明    举例

-b <span class="token function">file</span>    检测文件是否是块设备文件，如果是，则返回 true。    <span class="token punctuation">[</span> -b <span class="token variable">$file</span> <span class="token punctuation">]</span> 返回 false。

-c <span class="token function">file</span>    检测文件是否是字符设备文件，如果是，则返回 true。    <span class="token punctuation">[</span> -c <span class="token variable">$file</span> <span class="token punctuation">]</span> 返回 false。

-d <span class="token function">file</span>    检测文件是否是目录，如果是，则返回 true。    <span class="token punctuation">[</span> -d <span class="token variable">$file</span> <span class="token punctuation">]</span> 返回 false。

-f <span class="token function">file</span>    检测文件是否是普通文件（既不是目录，也不是设备文件），如果是，则返回 true。    <span class="token punctuation">[</span> -f <span class="token variable">$file</span> <span class="token punctuation">]</span> 返回 true。

-g <span class="token function">file</span>    检测文件是否设置了 SGID 位，如果是，则返回 true。    <span class="token punctuation">[</span> -g <span class="token variable">$file</span> <span class="token punctuation">]</span> 返回 false。

-k <span class="token function">file</span>    检测文件是否设置了粘着位<span class="token punctuation">(</span>Sticky Bit<span class="token punctuation">)</span>，如果是，则返回 true。    <span class="token punctuation">[</span> -k <span class="token variable">$file</span> <span class="token punctuation">]</span> 返回 false。

-p <span class="token function">file</span>    检测文件是否是具名管道，如果是，则返回 true。    <span class="token punctuation">[</span> -p <span class="token variable">$file</span> <span class="token punctuation">]</span> 返回 false。

-u <span class="token function">file</span>    检测文件是否设置了 SUID 位，如果是，则返回 true。    <span class="token punctuation">[</span> -u <span class="token variable">$file</span> <span class="token punctuation">]</span> 返回 false。

-r <span class="token function">file</span>    检测文件是否可读，如果是，则返回 true。    <span class="token punctuation">[</span> -r <span class="token variable">$file</span> <span class="token punctuation">]</span> 返回 true。

-w <span class="token function">file</span>    检测文件是否可写，如果是，则返回 true。    <span class="token punctuation">[</span> -w <span class="token variable">$file</span> <span class="token punctuation">]</span> 返回 true。

-x <span class="token function">file</span>    检测文件是否可执行，如果是，则返回 true。    <span class="token punctuation">[</span> -x <span class="token variable">$file</span> <span class="token punctuation">]</span> 返回 true。

-s <span class="token function">file</span>    检测文件是否为空（文件大小是否大于0），不为空返回 true。    <span class="token punctuation">[</span> -s <span class="token variable">$file</span> <span class="token punctuation">]</span> 返回 true。

-e <span class="token function">file</span>    检测文件（包括目录）是否存在，如果是，则返回 true。    <span class="token punctuation">[</span> -e <span class="token variable">$file</span> <span class="token punctuation">]</span> 返回 true。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="03-Shell脚本学习–字符串和数组"><a href="#03-Shell脚本学习–字符串和数组" class="headerlink" title="03- Shell脚本学习–字符串和数组"></a>03- Shell脚本学习–字符串和数组</h2><h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><p>字符串是shell编程中最常用最有用的数据类型（除了数字和字符串，也没啥其它类型好用了），字符串可以用单引号，也可以用双引号，也可以不用引号。单双引号的区别跟PHP类似：</p>
<p>单双引号的区别：</p>
<ul>
<li>双引号里可以有变量，单引号则原样输出；</li>
<li>双引号里可以出现转义字符，单引号则原样输出；</li>
<li>单引号字串中不能出现单引号。</li>
</ul>
<h3 id="拼接字符串"><a href="#拼接字符串" class="headerlink" title="拼接字符串"></a>拼接字符串</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

str1<span class="token operator">=</span><span class="token string">'i'</span>
str2<span class="token operator">=</span><span class="token string">'love'</span>
str3<span class="token operator">=</span><span class="token string">'you'</span>

<span class="token keyword">echo</span> <span class="token variable">$str1</span> <span class="token variable">$str2</span> <span class="token variable">$str3</span>
<span class="token keyword">echo</span> <span class="token variable">$str1</span><span class="token variable">$str2</span><span class="token variable">$str3</span>
<span class="token keyword">echo</span> <span class="token variable">$str1</span>,<span class="token variable">$str2</span>,<span class="token variable">$str3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出：</p>
<pre class="line-numbers language-txt"><code class="language-txt">i love you
iloveyou
i,love,you<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="获取字符串长度"><a href="#获取字符串长度" class="headerlink" title="获取字符串长度"></a>获取字符串长度</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>/

str<span class="token operator">=</span><span class="token string">'i love you'</span>

<span class="token keyword">echo</span> <span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>#str<span class="token punctuation">}</span><span class="token variable">`</span></span>

<span class="token comment" spellcheck="true"># 输出：10</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="截取字符串"><a href="#截取字符串" class="headerlink" title="截取字符串"></a>截取字符串</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>/

str<span class="token operator">=</span><span class="token string">'i love you'</span>

<span class="token keyword">echo</span> <span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>str:1<span class="token punctuation">}</span><span class="token variable">`</span></span> <span class="token comment" spellcheck="true"># 从第1个截取到末尾。注意从0开始。</span>
<span class="token keyword">echo</span> <span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>str:2:2<span class="token punctuation">}</span><span class="token variable">`</span></span> <span class="token comment" spellcheck="true"># 从第2个截取2个。</span>
<span class="token keyword">echo</span> <span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>str:0<span class="token punctuation">}</span><span class="token variable">`</span></span><span class="token comment" spellcheck="true"># 全部截取。</span>
<span class="token keyword">echo</span> <span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>str:-3<span class="token punctuation">}</span><span class="token variable">`</span></span> <span class="token comment" spellcheck="true"># 负数无效，视为0。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出：</p>
<pre class="line-numbers language-txt"><code class="language-txt">love you
lo
i love you
i love you<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="查找字符串"><a href="#查找字符串" class="headerlink" title="查找字符串"></a>查找字符串</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>/

str<span class="token operator">=</span><span class="token string">"i love you"</span>

<span class="token keyword">echo</span> `expr index <span class="token string">"<span class="token variable">$str</span>"</span> l<span class="token variable"><span class="token variable">`</span>
<span class="token keyword">echo</span> <span class="token variable">`</span></span><span class="token function">expr</span> index <span class="token string">"<span class="token variable">$str</span>"</span> you` <span class="token comment" spellcheck="true">#最后一个参数是字符，会对后面字符串每一个单独查找，返回最靠前的index</span>
<span class="token keyword">echo</span> `expr index <span class="token string">"<span class="token variable">$str</span>"</span> o<span class="token variable"><span class="token variable">`</span>
<span class="token keyword">echo</span> <span class="token variable">`</span></span><span class="token function">expr</span> length <span class="token string">"<span class="token variable">$str</span>"</span>` <span class="token comment" spellcheck="true">#字符串长度</span>
<span class="token keyword">echo</span> `expr substr <span class="token string">"<span class="token variable">$str</span>"</span> 1 6` <span class="token comment" spellcheck="true">#从字符串中位置1开始截取6个字符。索引是从0开始的。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出:</p>
<pre class="line-numbers language-txt"><code class="language-txt">3
4
4
10
i love<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>注意字符串变量需要加双引号。第2个例子里<code>you</code>虽然<code>y</code>的index是8,但是<code>o</code>在前面已经出现过,index是4，最终取所有字符里最靠前的index。</p>
<p>*拓展：<code>expr</code>更多关于字符串用法：</p>
<pre class="line-numbers language-bash"><code class="language-bash">STRING <span class="token keyword">:</span> REGEXP   anchored pattern match of REGEXP <span class="token keyword">in</span> STRING

match STRING REGEXP        same as STRING <span class="token keyword">:</span> REGEXP

substr STRING POS LENGTH   <span class="token comment" spellcheck="true">#从STRING中POS位置开始截取LENGTH个字符。POS索引是从1开始的。</span>

index STRING CHARS         <span class="token comment" spellcheck="true">#在STRING中查找字符CHARS首次出现的位置，没有找到返回0</span>

length STRING              <span class="token comment" spellcheck="true">#字符串长度</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><p>bash支持一维数组（不支持多维数组），并且没有限定数组的大小。类似与C语言，数组元素的下标由0开始编号。获取数组中的元素要利用下标，下标可以是整数或算术表达式，其值应大于或等于0。</p>
<p>在Shell中，用括号来表示数组，数组元素用<code>空格</code>符号分割开。定义数组的一般形式为：</p>
<pre class="line-numbers language-bash"><code class="language-bash">array_name<span class="token operator">=</span><span class="token punctuation">(</span>value1 value2 <span class="token punctuation">..</span>. valuen<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>例如：</p>
<pre class="line-numbers language-bash"><code class="language-bash">array_name<span class="token operator">=</span><span class="token punctuation">(</span>value0 value1 value2 value3<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>或者</p>
<pre class="line-numbers language-bash"><code class="language-bash">array_name<span class="token operator">=</span><span class="token punctuation">(</span>
    value0
    value1
    value2
    value3
<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>还可以单独定义数组的各个分量：</p>
<pre class="line-numbers language-bash"><code class="language-bash">array_name<span class="token punctuation">[</span>0<span class="token punctuation">]</span><span class="token operator">=</span>value0
array_name<span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token operator">=</span>value1
array_name<span class="token punctuation">[</span>2<span class="token punctuation">]</span><span class="token operator">=</span>value2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>可以不使用连续的下标，而且下标的范围没有限制。</p>
<p>下面来读取数组：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token keyword">echo</span> $<span class="token variable"><span class="token variable">`</span><span class="token punctuation">{</span>array_name<span class="token punctuation">[</span>2<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token variable">`</span></span> <span class="token comment" spellcheck="true">#读取下标为2的元素</span>
<span class="token keyword">echo</span> $<span class="token variable"><span class="token variable">`</span><span class="token punctuation">{</span>array_name<span class="token punctuation">[</span>*<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token variable">`</span></span> <span class="token comment" spellcheck="true">#读取所有元素</span>
<span class="token keyword">echo</span> $<span class="token variable"><span class="token variable">`</span><span class="token punctuation">{</span>array_name<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token variable">`</span></span> <span class="token comment" spellcheck="true">#读取所有元素</span>


<span class="token keyword">echo</span> $<span class="token variable"><span class="token variable">`</span><span class="token punctuation">{</span>#array_name<span class="token punctuation">[</span>*<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token variable">`</span></span> <span class="token comment" spellcheck="true">#获取数组长度</span>
<span class="token keyword">echo</span> $<span class="token variable"><span class="token variable">`</span><span class="token punctuation">{</span>#array_name<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token variable">`</span></span> <span class="token comment" spellcheck="true">#获取数组长度</span>
<span class="token keyword">echo</span> $<span class="token variable"><span class="token variable">`</span><span class="token punctuation">{</span>#array_name<span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token variable">`</span></span> <span class="token comment" spellcheck="true">#获取数组中单个元素的长度</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出：</p>
<pre class="line-numbers language-bash"><code class="language-bash">value2
value0 value1 value2 value3
value0 value1 value2 value3
4
4
6<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>对比shell里字符串和数组，我们发现：</p>
<p>字符串</p>
<pre class="line-numbers language-bash"><code class="language-bash">str<span class="token operator">=</span><span class="token string">"hello"</span>
<span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>#str<span class="token punctuation">}</span><span class="token variable">`</span></span> <span class="token comment" spellcheck="true"># 读取字符串长度</span>
<span class="token keyword">echo</span> <span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>str<span class="token punctuation">}</span><span class="token variable">`</span></span> <span class="token comment" spellcheck="true"># 读取字符串全部</span>
<span class="token keyword">echo</span> <span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>str:1<span class="token punctuation">}</span><span class="token variable">`</span></span> <span class="token comment" spellcheck="true"># 截取字符串</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>数组：</p>
<pre class="line-numbers language-bash"><code class="language-bash">arr<span class="token operator">=</span><span class="token punctuation">(</span>a1 a2 a3<span class="token punctuation">)</span>
<span class="token keyword">echo</span> <span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>#arr<span class="token punctuation">[</span>*<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token variable">`</span></span> <span class="token comment" spellcheck="true"># 读取数组长度</span>
<span class="token keyword">echo</span> <span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>#arr<span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token variable">`</span></span> <span class="token comment" spellcheck="true"># 读取数组某个元素长度</span>

<span class="token keyword">echo</span> <span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>arr<span class="token punctuation">[</span>*<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token variable">`</span></span> <span class="token comment" spellcheck="true"># 读取数组全部</span>
<span class="token keyword">echo</span> <span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{</span>arr<span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token variable">`</span></span> <span class="token comment" spellcheck="true"># 读取数组某个元素</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="04-Shell脚本学习–条件控制"><a href="#04-Shell脚本学习–条件控制" class="headerlink" title="04- Shell脚本学习–条件控制"></a>04- Shell脚本学习–条件控制</h2><h3 id="条件判断：if语句"><a href="#条件判断：if语句" class="headerlink" title="条件判断：if语句"></a>条件判断：if语句</h3><p>语法格式：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token keyword">if</span> <span class="token punctuation">[</span> expression <span class="token punctuation">]</span>
<span class="token keyword">then</span>
   Statement<span class="token punctuation">(</span>s<span class="token punctuation">)</span> to be executed <span class="token keyword">if</span> expression is <span class="token boolean">true</span>
<span class="token keyword">fi</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>注意：<code>expression</code> 和方括号([ ])之间必须有空格，否则会有语法错误。</p>
<p>if 语句通过关系运算符判断表达式的真假来决定执行哪个分支。Shell 有三种 if … else 语句：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token keyword">if</span> <span class="token punctuation">..</span>. <span class="token keyword">fi</span> 语句
<span class="token keyword">if</span> <span class="token punctuation">..</span>. <span class="token keyword">else</span> <span class="token punctuation">..</span>. <span class="token keyword">fi</span> 语句
<span class="token keyword">if</span> <span class="token punctuation">..</span>. <span class="token keyword">elif</span> <span class="token punctuation">..</span>. <span class="token keyword">else</span> <span class="token punctuation">..</span>. <span class="token keyword">fi</span> 语句<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>示例：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>/

a<span class="token operator">=</span>10
b<span class="token operator">=</span>20
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$a</span> <span class="token operator">==</span> <span class="token variable">$b</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span> 
    <span class="token keyword">echo</span> <span class="token string">"a is equal to b"</span>
<span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$a</span> -gt <span class="token variable">$b</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
    <span class="token keyword">echo</span> <span class="token string">"a is greater to b"</span>
<span class="token keyword">else</span>
    <span class="token keyword">echo</span> <span class="token string">"a is less to b"</span>
<span class="token keyword">fi</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>if ... else</code> 语句也可以写成一行，以命令的方式来运行:</p>
<pre class="line-numbers language-bash"><code class="language-bash">a<span class="token operator">=</span>10<span class="token punctuation">;</span>b<span class="token operator">=</span>20<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$a</span> <span class="token operator">==</span> <span class="token variable">$b</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span> <span class="token keyword">echo</span> <span class="token string">"a is equal to b"</span><span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token keyword">echo</span> <span class="token string">"a is not equal to b"</span><span class="token punctuation">;</span><span class="token keyword">fi</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>if ... else</code> 语句也经常与 <code>test</code> 命令结合使用，作用与上面一样：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>/

a<span class="token operator">=</span>10
b<span class="token operator">=</span>20
<span class="token keyword">if</span> <span class="token function">test</span> <span class="token variable">$a</span> <span class="token operator">==</span> <span class="token variable">$b</span> 
<span class="token keyword">then</span> 
    <span class="token keyword">echo</span> <span class="token string">"a is equal to b"</span>
<span class="token keyword">else</span>
    <span class="token keyword">echo</span> <span class="token string">"a is not equal to b"</span>
<span class="token keyword">fi</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="分支控制：case语句"><a href="#分支控制：case语句" class="headerlink" title="分支控制：case语句"></a>分支控制：case语句</h3><p><code>case ... esac</code> 与其他语言中的 <code>switch ... case</code> 语句类似，是一种多分枝选择结构。</p>
<p>示例：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>/

grade<span class="token operator">=</span><span class="token string">"B"</span>

<span class="token keyword">case</span> <span class="token variable">$grade</span> <span class="token keyword">in</span> 
    <span class="token string">"A"</span><span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token string">"Very Good!"</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token string">"B"</span><span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token string">"Good!"</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token string">"C"</span><span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token string">"Come On!"</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    *<span class="token punctuation">)</span> 
        <span class="token keyword">echo</span> <span class="token string">"You Must Try!"</span>
        <span class="token keyword">echo</span> <span class="token string">"Sorry!"</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
esac<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>转换成C语言是：</p>
<pre class="line-numbers language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">char</span> grade <span class="token operator">=</span> <span class="token string">'B'</span><span class="token punctuation">;</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>grade<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">'A'</span><span class="token punctuation">:</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Very Good!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Very Good!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'C'</span><span class="token punctuation">:</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Very Good!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token punctuation">:</span> 
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"You Must Try!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Sorry!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>对比看就很容易理解了。很相似，只是格式不一样。</p>
<p>需要注意的是：<br><strong>取值后面必须为关键字 in，每一模式必须以右括号结束。取值可以为变量或常数。匹配发现取值符合某一模式后，其间所有命令开始执行直至 <code>;;</code>。</strong><code>;;</code> 与其他语言中的 <code>break</code> 类似，意思是跳到整个 <code>case</code> 语句的最后。</p>
<p>取值将检测匹配的每一个模式。一旦模式匹配，则执行完匹配模式相应命令后不再继续其他模式。如果无一匹配模式，使用星号 <code>*</code> 捕获该值，再执行后面的命令。</p>
<p>再举一个例子：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
option<span class="token operator">=</span><span class="token string">"<span class="token variable">${1}</span>"</span>
<span class="token keyword">case</span> <span class="token variable">${option}</span> <span class="token keyword">in</span>
   <span class="token string">"-f"</span><span class="token punctuation">)</span> FILE<span class="token operator">=</span><span class="token string">"$<span class="token variable"><span class="token variable">`</span><span class="token punctuation">{</span>2<span class="token punctuation">}</span><span class="token variable">`</span></span>"</span>
      <span class="token keyword">echo</span> <span class="token string">"File name is <span class="token variable">$FILE</span>"</span>
      <span class="token punctuation">;</span><span class="token punctuation">;</span>
   <span class="token string">"-d"</span><span class="token punctuation">)</span> DIR<span class="token operator">=</span><span class="token string">"$<span class="token variable"><span class="token variable">`</span><span class="token punctuation">{</span>2<span class="token punctuation">}</span><span class="token variable">`</span></span>"</span>
      <span class="token keyword">echo</span> <span class="token string">"Dir name is <span class="token variable">$DIR</span>"</span>
      <span class="token punctuation">;</span><span class="token punctuation">;</span>
   *<span class="token punctuation">)</span> 
      <span class="token keyword">echo</span> <span class="token string">"<span class="token variable"><span class="token variable">`</span><span class="token function">basename</span> $<span class="token variable">`</span></span>{0}``:usage: [-f file] | [-d directory]"</span>
      <span class="token keyword">exit</span> 1 <span class="token comment" spellcheck="true"># Command to come out of the program with status 1</span>
      <span class="token punctuation">;</span><span class="token punctuation">;</span>
esac<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>运行结果：</p>
<pre class="line-numbers language-bash"><code class="language-bash">$./test.sh
test.sh: usage: <span class="token punctuation">[</span> -f filename <span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">[</span> -d directory <span class="token punctuation">]</span>

./test.sh -f index.html
File name is index.html<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里用到了特殊变量<code>${1}</code>,指的是获取命令行的第一个参数。</p>
<p>下面结合<code>getopts</code>命令介绍下一个经典的例子：从命令行读取参数。</p>
<p>run.sh  </p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/sh</span>

usage<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token string">"Usage: <span class="token variable">$0</span> -s [start|stop|reload|restart] -e [online|test]"</span>
    <span class="token keyword">exit</span> 1
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> -z <span class="token variable">$1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    usage
<span class="token keyword">fi</span>

<span class="token keyword">while</span> <span class="token function">getopts</span> <span class="token string">'s:e:h'</span> OPT<span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token keyword">case</span> <span class="token variable">$OPT</span> <span class="token keyword">in</span>
        s<span class="token punctuation">)</span> cmd<span class="token operator">=</span><span class="token string">"<span class="token variable">$OPTARG</span>"</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
        e<span class="token punctuation">)</span> env<span class="token operator">=</span><span class="token string">"<span class="token variable">$OPTARG</span>"</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
        h<span class="token punctuation">)</span> usage<span class="token punctuation">;</span><span class="token punctuation">;</span>
        ?<span class="token punctuation">)</span> usage<span class="token punctuation">;</span><span class="token punctuation">;</span>
    esac
<span class="token keyword">done</span>

<span class="token keyword">echo</span> <span class="token variable">$cmd</span>
<span class="token keyword">echo</span> <span class="token variable">$env</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>当我们直接运行<code>run.sh</code>的时候，会调用<code>usage</code>显示帮助；如果输入正确的参数，则会进入正确的流程。运行示例：</p>
<pre class="line-numbers language-bash"><code class="language-bash">sh run.sh -s start -e <span class="token function">test</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h3><p>shell的for循环与c、php等语言不同，同Python很类似。下面是语法格式：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token keyword">for</span> 变量 <span class="token keyword">in</span> 列表
<span class="token keyword">do</span>
    command1
    command2
    <span class="token punctuation">..</span>.
    commandN
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>示例：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>/

<span class="token keyword">for</span> value <span class="token keyword">in</span> 1 2 3 4 5
<span class="token keyword">do</span> 
    <span class="token keyword">echo</span> <span class="token string">"The value is <span class="token variable">$value</span>"</span>
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出：</p>
<pre class="line-numbers language-bash"><code class="language-bash">The value is 1
The value is 2
The value is 3
The value is 4
The value is 5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>顺序输出字符串中的字符：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token keyword">for</span> str <span class="token keyword">in</span> <span class="token string">'This is a string'</span>
<span class="token keyword">do</span>
    <span class="token keyword">echo</span> <span class="token variable">$str</span>
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>运行结果：</p>
<pre class="line-numbers language-txt"><code class="language-txt">This is a string<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>遍历目录下的文件：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token keyword">for</span> FILE <span class="token keyword">in</span> *
<span class="token keyword">do</span>
   <span class="token keyword">echo</span> <span class="token variable">$FILE</span>
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>上面的代码将遍历当前目录下所有的文件。在Linux下，可以改为其他目录试试。</p>
<p>遍历文件内容：<br>city.txt</p>
<pre class="line-numbers language-txt"><code class="language-txt">beijing
tianjin
shanghai<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

citys<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> city.txt<span class="token variable">`</span></span>
<span class="token keyword">for</span> city <span class="token keyword">in</span> <span class="token variable">$citys</span>
<span class="token keyword">do</span>
   <span class="token keyword">echo</span> <span class="token variable">$city</span>
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出：</p>
<pre class="line-numbers language-txt"><code class="language-txt">beijing
tianjin
shanghai<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="while循环"><a href="#while循环" class="headerlink" title="while循环"></a>while循环</h3><p>只要while后面的条件满足，就一直执行do里面的代码块。</p>
<p>其格式为：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token keyword">while</span> <span class="token function">command</span>
<span class="token keyword">do</span>
   Statement<span class="token punctuation">(</span>s<span class="token punctuation">)</span> to be executed <span class="token keyword">if</span> <span class="token function">command</span> is <span class="token boolean">true</span>
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>命令执行完毕，控制返回循环顶部，从头开始直至测试条件为假。</p>
<p>示例：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

c<span class="token operator">=</span>0<span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable">$c</span> -lt 3 <span class="token punctuation">]</span>
<span class="token keyword">do</span>
    <span class="token keyword">echo</span> <span class="token string">"Value c is <span class="token variable">$c</span>"</span>
    c<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $c + 1<span class="token variable">`</span></span>
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出：</p>
<pre class="line-numbers language-txt"><code class="language-txt">Value c is 0
Value c is 1
Value c is 2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>这里由于shell本身不支持算数运算，所以使用<code>expr</code>命令进行自增。</p>
<h3 id="until循环"><a href="#until循环" class="headerlink" title="until循环"></a>until循环</h3><p>until 循环执行一系列命令直至条件为 true 时停止。until 循环与 while 循环在处理方式上刚好相反。一般while循环优于until循环，但在某些时候，也只是极少数情况下，until 循环更加有用。</p>
<p>将上面while循环的例子改改，就能达到一样的效果：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

c<span class="token operator">=</span>0<span class="token punctuation">;</span>
<span class="token keyword">until</span> <span class="token punctuation">[</span> <span class="token variable">$c</span> -eq 3 <span class="token punctuation">]</span>
<span class="token keyword">do</span>
    <span class="token keyword">echo</span> <span class="token string">"Value c is <span class="token variable">$c</span>"</span>
    c<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $c + 1<span class="token variable">`</span></span>
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>首先do里面的语句块一直在运行，直到满足了until的条件就停止。</p>
<p>输出：</p>
<pre class="line-numbers language-txt"><code class="language-txt">Value c is 0
Value c is 1
Value c is 2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="跳出循环"><a href="#跳出循环" class="headerlink" title="跳出循环"></a>跳出循环</h3><p>在循环过程中，有时候需要在未达到循环结束条件时强制跳出循环，像大多数编程语言一样，Shell也使用 break 和 continue 来跳出循环。</p>
<h3 id="break"><a href="#break" class="headerlink" title="break"></a>break</h3><p>break命令允许跳出所有循环（终止执行后面的所有循环）。</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

i<span class="token operator">=</span>0
<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable">$i</span> -lt 5 <span class="token punctuation">]</span>
<span class="token keyword">do</span>
    i<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $i + 1<span class="token variable">`</span></span>

    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$i</span> <span class="token operator">==</span> 3 <span class="token punctuation">]</span>
        <span class="token keyword">then</span>
            <span class="token keyword">break</span>
    <span class="token keyword">fi</span>
    <span class="token keyword">echo</span> -e <span class="token variable">$i</span>
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>运行结果：</p>
<pre class="line-numbers language-txt"><code class="language-txt">1
2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>在嵌套循环中，break 命令后面还可以跟一个整数，表示跳出第几层循环。例如：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token keyword">break</span> n<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>表示跳出第 n 层循环。</p>
<h3 id="continue"><a href="#continue" class="headerlink" title="continue"></a>continue</h3><p>continue命令与break命令类似，只有一点差别，它不会跳出所有循环，仅仅跳出当前循环。</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

i<span class="token operator">=</span>0
<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable">$i</span> -lt 5 <span class="token punctuation">]</span>
<span class="token keyword">do</span>
    i<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $i + 1<span class="token variable">`</span></span>

    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$i</span> <span class="token operator">==</span> 3 <span class="token punctuation">]</span>
        <span class="token keyword">then</span>
            <span class="token keyword">continue</span>
    <span class="token keyword">fi</span>
    <span class="token keyword">echo</span> -e <span class="token variable">$i</span>

<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>运行结果：</p>
<pre class="line-numbers language-txt"><code class="language-txt">1
2
4
5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="05-Shell脚本学习–函数"><a href="#05-Shell脚本学习–函数" class="headerlink" title="05- Shell脚本学习–函数"></a>05- Shell脚本学习–函数</h2><p>函数可以让我们将一个复杂功能划分成若干模块，让程序结构更加清晰，代码重复利用率更高。像其他编程语言一样，Shell 也支持函数。Shell 函数必须先定义后使用。</p>
<h3 id="函数定义"><a href="#函数定义" class="headerlink" title="函数定义"></a>函数定义</h3><p>Shell 函数的定义格式如下：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token keyword">function</span> function_name <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    list of commands
    <span class="token punctuation">[</span> <span class="token keyword">return</span> value <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>其中<code>function</code>关键字是可选的。</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

hello<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

hello<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>运行结果：</p>
<pre class="line-numbers language-txt"><code class="language-txt">hello<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>调用函数只需要给出函数名，不需要加括号。</p>
<p>函数返回值，可以显式增加return语句；如果不加，会将最后一条命令运行结果作为返回值。</p>
<p>Shell 函数返回值只能是整数，一般用来表示函数执行成功与否，0表示成功，其他值表示失败。如果 return 其他数据，比如一个字符串，往往会得到错误提示：<code>numeric argument required</code>。</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token keyword">function</span> hello<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

hello<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>运行结果：</p>
<pre class="line-numbers language-bash"><code class="language-bash">line 4: return: hello: numeric argument required<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>如果一定要让函数返回字符串，那么可以先定义一个变量，用来接收函数的计算结果，脚本在需要的时候访问这个变量来获得函数返回值。</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token keyword">function</span> hello<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

str<span class="token operator">=</span>hello

<span class="token keyword">echo</span> <span class="token variable">$str</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>运行结果：</p>
<pre class="line-numbers language-txt"><code class="language-txt">hello<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>像删除变量一样，删除函数也可以使用 <code>unset</code> 命令，不过要加上 <code>.f</code> 选项，如下所示：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token variable">$unset</span> .f function_name<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>如果你希望直接从终端调用函数，可以将函数定义在主目录下的 .profile 文件，这样每次登录后，在命令提示符后面输入函数名字就可以立即调用。</p>
<h3 id="函数参数"><a href="#函数参数" class="headerlink" title="函数参数"></a>函数参数</h3><p>在Shell中，调用函数时可以向其传递参数。在函数体内部，通过 <code>$n</code> 的形式来获取参数的值，例如，<code>$1</code>表示第一个参数，<code>$2</code>表示第二个参数…这就是前面讲的特殊变量。</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token keyword">function</span> sum<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">case</span> $<span class="token comment" spellcheck="true"># in </span>
        0<span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token string">"no param"</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
        1<span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token variable">$1</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
        2<span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $1 + $2<span class="token variable">`</span></span><span class="token punctuation">;</span><span class="token punctuation">;</span>
        3<span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $1 + $2 + $3<span class="token variable">`</span></span><span class="token punctuation">;</span><span class="token punctuation">;</span>
        *<span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$#</span> params! It's too much!"</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    esac
<span class="token punctuation">}</span>

<span class="token function">sum</span> 1 3 5 6<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>运行结果：</p>
<pre class="line-numbers language-txt"><code class="language-txt">4 params! It's too much!<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>注意，<code>$10</code> 不能获取第十个参数，获取第十个参数需要<code>${10}</code>。当<code>n&gt;=10</code>时，需要使用<code>${n}</code>来获取参数。</p>
<p>另外，还有几个特殊变量用来处理参数，前面已经提到：</p>
<pre class="line-numbers language-bash"><code class="language-bash">特殊变量    说明
$<span class="token comment" spellcheck="true">#    传递给函数的参数个数。</span>
<span class="token variable">$*</span>    显示所有传递给函数的参数。
<span class="token variable">$@</span>    与<span class="token variable">$*</span>相同，但是略有区别，请查看Shell特殊变量。
<span class="token variable">$?</span>    函数的返回值。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="如何获取函数返回值"><a href="#如何获取函数返回值" class="headerlink" title="如何获取函数返回值"></a>如何获取函数返回值</h3><p>后面的变量需要使用函数的返回值，怎么实现？  </p>
<p>示例：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token keyword">function</span> sum<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> 1+2+3<span class="token variable">`</span></span>
<span class="token punctuation">}</span>

num<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">sum</span><span class="token variable">)</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这样就可以取到返回值了。</p>
<h2 id="06-Shell脚本学习–其它"><a href="#06-Shell脚本学习–其它" class="headerlink" title="06- Shell脚本学习–其它"></a>06- Shell脚本学习–其它</h2><h3 id="Shell输入输出重定向"><a href="#Shell输入输出重定向" class="headerlink" title="Shell输入输出重定向"></a>Shell输入输出重定向</h3><p>Unix 命令默认从标准输入设备(stdin)获取输入，将结果输出到标准输出设备(stdout)显示。一般情况下，标准输入设备就是键盘，标准输出设备就是终端，即显示器。<br>输出重定向</p>
<p>命令的输出不仅可以是显示器，还可以很容易的转移向到文件，这被称为输出重定向。</p>
<p>命令输出重定向的语法为：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">command</span> <span class="token operator">></span> <span class="token function">file</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>这样，输出到显示器的内容就可以被重定向到文件。</p>
<p>例如，下面的命令在显示器上不会看到任何输出：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">who</span> <span class="token operator">></span> <span class="token function">users</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>打开 users 文件，可以看到下面的内容：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">cat</span> <span class="token function">users</span>

oko         tty01   Sep 12 07:30
ai          tty15   Sep 12 13:32
ruth        tty21   Sep 12 10:10
pat         tty24   Sep 12 13:07
steve       tty25   Sep 12 13:03<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出重定向会覆盖文件内容，请看下面的例子：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token keyword">echo</span> line 1 <span class="token operator">></span> <span class="token function">users</span>

<span class="token function">cat</span> <span class="token function">users</span>
line 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>如果不希望文件内容被覆盖，可以使用 <code>&gt;&gt;</code> 追加到文件末尾，例如：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token keyword">echo</span> line 2 <span class="token operator">>></span> <span class="token function">users</span>

<span class="token function">cat</span> <span class="token function">users</span>
line 1
line 2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输入重定向</p>
<p>和输出重定向一样，Unix 命令也可以从文件获取输入，语法为：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">command</span> <span class="token operator">&lt;</span> <span class="token function">file</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>这样，本来需要从键盘获取输入的命令会转移到文件读取内容。</p>
<p>注意：输出重定向是大于号(&gt;)，输入重定向是小于号(&lt;)。</p>
<p>例如，计算 users 文件中的行数，可以使用下面的命令：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">wc</span> -l <span class="token function">users</span>
2 <span class="token function">users</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>也可以将输入重定向到 users 文件：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">wc</span> -l <span class="token operator">&lt;</span> <span class="token function">users</span>
2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>注意：上面两个例子的结果不同：第一个例子，会输出文件名；第二个不会，因为它仅仅知道从标准输入读取内容。</p>
<h3 id="重定向深入讲解"><a href="#重定向深入讲解" class="headerlink" title="重定向深入讲解"></a>重定向深入讲解</h3><p>一般情况下，每个 Unix/Linux 命令运行时都会打开三个文件：</p>
<ul>
<li>**标准输入文件(stdin)**：stdin的文件描述符为0，Unix程序默认从stdin读取数据。</li>
<li>**标准输出文件(stdout)**：stdout 的文件描述符为1，Unix程序默认向stdout输出数据。</li>
<li>**标准错误文件(stderr)**：stderr的文件描述符为2，Unix程序会向stderr流中写入错误信息。</li>
</ul>
<p>默认情况下，<code>command &gt; file</code> 将 stdout 重定向到 file，<code>command &lt; file</code> 将stdin 重定向到 file。</p>
<p>如果希望 stderr 重定向到 file，可以这样写：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">command</span> 2 <span class="token operator">></span> <span class="token function">file</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>如果希望 stderr 追加到 file 文件末尾，可以这样写：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">command</span> 2 <span class="token operator">>></span> <span class="token function">file</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>2 表示标准错误文件(stderr)。</p>
<p>如果希望将 stdout 和 stderr 合并后重定向到 file，可以这样写：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">command</span> <span class="token operator">></span> <span class="token function">file</span> 2<span class="token operator">></span><span class="token operator">&amp;</span>1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>如果希望对 stdin 和 stdout 都重定向，可以这样写：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">command</span> <span class="token operator">&lt;</span> file1 <span class="token operator">></span>file2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>command 命令将 stdin 重定向到 file1，将 stdout 重定向到 file2。 </p>
<p><strong>全部可用的重定向命令列表：</strong></p>
<pre class="line-numbers language-bash"><code class="language-bash">命令    说明
<span class="token function">command</span> <span class="token operator">></span> <span class="token function">file</span>    将输出重定向到 file。
<span class="token function">command</span> <span class="token operator">&lt;</span> <span class="token function">file</span>    将输入重定向到 file。
<span class="token function">command</span> <span class="token operator">>></span> <span class="token function">file</span>    将输出以追加的方式重定向到 file。
n <span class="token operator">></span> <span class="token function">file</span>    将文件描述符为 n 的文件重定向到 file。
n <span class="token operator">>></span> <span class="token function">file</span>    将文件描述符为 n 的文件以追加的方式重定向到 file。
n <span class="token operator">></span><span class="token operator">&amp;</span> m    将输出文件 m 和 n 合并。
n <span class="token operator">&lt;</span><span class="token operator">&amp;</span> m    将输入文件 m 和 n 合并。
<span class="token operator">&lt;&lt;</span> tag    将开始标记 tag 和结束标记 tag 之间的内容作为输入。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Here-Document"><a href="#Here-Document" class="headerlink" title="Here Document"></a>Here Document</h3><p>Here Document 目前没有统一的翻译，这里暂译为<code>嵌入文档</code>。Here Document 是 Shell 中的一种特殊的重定向方式，它的基本的形式如下：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">command</span> <span class="token operator">&lt;&lt;</span> <span class="token string">delimiter
    document
delimiter</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>它的作用是将两个 delimiter 之间的内容(document) 作为输入传递给 command。</p>
<p>注意：<br><strong>结尾的delimiter 一定要顶格写</strong>，前面不能有任何字符，后面也不能有任何字符，包括空格和 tab 缩进。</p>
<p>开始的delimiter前后的空格会被忽略掉。</p>
<p>下面的例子，通过 <code>wc -l</code> 命令计算 document 的行数：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">wc</span> -l <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
    This is a simple lookup program
    for good (and bad) restaurants
    in Cape Town.
EOF</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>输出： 3</p>
<p>也可以 将 Here Document 用在脚本中，例如：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
This is a simple lookup program
for good (and bad) restaurants
in Cape Town.
EOF</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>运行结果：</p>
<pre class="line-numbers language-txt"><code class="language-txt">This is a simple lookup program
for good (and bad) restaurants
in Cape Town.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="dev-null-文件"><a href="#dev-null-文件" class="headerlink" title="/dev/null 文件"></a>/dev/null 文件</h3><p>如果希望执行某个命令，但又不希望在屏幕上显示输出结果，那么可以将输出重定向到 <code>/dev/null</code>：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">command</span> <span class="token operator">></span> /dev/null<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>/dev/null</code> 是一个特殊的文件，写入到它的内容都会被丢弃；如果尝试从该文件读取内容，那么什么也读不到。但是 <code>/dev/null</code> 文件非常有用，将命令的输出重定向到它，会起到<code>禁止输出</code>的效果。</p>
<p>如果希望屏蔽 stdout 和 stderr，可以这样写：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">command</span> <span class="token operator">></span> /dev/null 2<span class="token operator">></span><span class="token operator">&amp;</span>1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>这样不会在屏幕打印任何信息。</p>
<h3 id="Shell文件包含"><a href="#Shell文件包含" class="headerlink" title="Shell文件包含"></a>Shell文件包含</h3><p>像其他语言一样，Shell 也可以包含外部脚本，将外部脚本的内容合并到当前脚本。</p>
<p>Shell 中包含脚本可以使用 <code>. filename</code> 或 <code>source filename</code> 。</p>
<p>两种方式的效果相同，简单起见，一般使用点号(.)，但是注意点号(.)和文件名中间有一空格。</p>
<p>示例：<br>被包含文件：sub.sh</p>
<pre class="line-numbers language-txt"><code class="language-txt">name="yjc"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>主文件：test.sh</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token keyword">.</span> ./sub.sh
<span class="token keyword">echo</span> <span class="token variable">$name</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>运行结果：</p>
<pre class="line-numbers language-txt"><code class="language-txt">yjc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="获取当前正在执行脚本的绝对路径"><a href="#获取当前正在执行脚本的绝对路径" class="headerlink" title="获取当前正在执行脚本的绝对路径"></a>获取当前正在执行脚本的绝对路径</h3><p>正确的命令是：</p>
<pre class="line-numbers language-bash"><code class="language-bash">basepath<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cd</span> `dirname $0`<span class="token punctuation">;</span> <span class="token function">pwd</span><span class="token variable">)</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>直接使用<code>pwd</code>或者<code>dirname $0</code>是不对的。</p>
<h3 id="按特定字符串截取字符串"><a href="#按特定字符串截取字符串" class="headerlink" title="按特定字符串截取字符串"></a>按特定字符串截取字符串</h3><p>示例：截取<code>/www/html/php/myapp/</code>里的myapp。</p>
<p>方案：</p>
<pre class="line-numbers language-bash"><code class="language-bash">str<span class="token operator">=</span>/www/html/php/myapp/
b<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">$(</span>echo <span class="token variable">$str</span><span class="token operator">|</span><span class="token function">sed</span> <span class="token string">'s#/# #g'</span><span class="token punctuation">))</span>
b_len<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $<span class="token punctuation">{</span>#b<span class="token punctuation">[</span>*<span class="token punctuation">]</span><span class="token punctuation">}</span> - 1<span class="token variable">`</span></span>
app_name<span class="token operator">=</span>$<span class="token variable"><span class="token variable">`</span><span class="token punctuation">{</span>b<span class="token punctuation">[</span>$b_len<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token variable">`</span></span>
<span class="token keyword">echo</span> <span class="token variable">$app_name</span>
<span class="token comment" spellcheck="true"># 计算数组长度：`${#arr[*]}`  </span>
<span class="token comment" spellcheck="true"># 计算则需要使用`expr`命令</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里利用<code>sed</code>将字符串按指定字符截成数组，然后取最后一个。  </p>
<h3 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h3><h3 id="awk简介"><a href="#awk简介" class="headerlink" title="awk简介"></a>awk简介</h3><p>awk是一个强大的文本分析工具，相对于grep的查找，sed的编辑，awk在其对数据分析并生成报告时，显得尤为强大。简单来说awk就是把文件(或其他方式的输入流, 如重定向输入)逐行的读入（看作一个记录集）, 把每一行看作一条记录，以空格(或\t,或用户自己指定的分隔符)为默认分隔符将每行切片（类似字段），切开的部分再进行各种分析处理。</p>
<p>awk有3个不同版本: awk、nawk和gawk，未作特别说明，一般指gawk，gawk 是 AWK 的 GNU 版本。</p>
<p>Awk基本语法:　</p>
<pre class="line-numbers language-shell"><code class="language-shell">awk 'pattern1 `{command1;command 2…; command 3}  pattern2 { command …}`'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>pattern表示用来过滤记录的模式,可是是正则表达式，关系运算表达式，也可以什么也没有(表示选中所有记录)。</p>
<p>每个pattern选中的行记录会被花括号括起来的命令command操作一遍, command之间用<code>;</code>分割。 花括号里面可以什么也没有, 则默认为print输出整行记录。 Comamnd可以是输出， 可以是算术运算，逻辑运算，循环控制等等。</p>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>s.txt</p>
<pre class="line-numbers language-txt"><code class="language-txt">zhangsan 1977 male computer 83
lisi 1989 male math 99
wanglijiang 1990 female chinese 78
xuliang 1977 male economic 89
xuxin 1986 female english 99
wangxuebing 1978 male math 89
lichang 1989 male math 99
wanglijiang 1990 female chinese 78
zhangsansan 1977 male computer 83 
langxuebing 1978 male math 89
lisibao 1989 male math 99
xiaobao 1990 female chinese 78<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>一行中的5个字段分别表示<code>姓名, 出生年, 性别,科目,分数</code>, 是一个很传统很典型的报表文件。</p>
<p>现在演示awk是如何查找的：</p>
<p>1)直接输出1990年出生的同学:</p>
<pre class="line-numbers language-shell"><code class="language-shell">$ awk '/1990/' s.txt

wanglijiang 1990 female chinese 78
wanglijiang 1990 female chinese 78
xiaobao 1990 female chinese 78
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>或者：</p>
<pre class="line-numbers language-txt"><code class="language-txt">$ awk '/1990/{print $0}' s.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>awk默认把输入的内容以空格拆分出每列。<code>$0</code>表示匹配所有列，<code>print $0</code>将输出所有列，每列分隔符是空格。</p>
<p>2）对chinese的课程的行输出”语文”：</p>
<pre class="line-numbers language-shell"><code class="language-shell">$ awk '/chinese/`{print "语文"}`' s.txt

语文
语文
语文
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3）记录的头部和结尾加上一段说明：</p>
<pre class="line-numbers language-shell"><code class="language-shell">$ awk 'BEGIN`{print "Result of the quiz:\n"}{print $0}END{print "------"}`' s.txt
Result of the quiz:

zhangsan 1977 male computer 83
lisi 1989 male math 99
wanglijiang 1990 female chinese 78
xuliang 1977 male economic 89
xuxin 1986 female english 99
wangxuebing 1978 male math 89
lichang 1989 male math 99
wanglijiang 1990 female chinese 78
zhangsansan 1977 male computer 83
langxuebing 1978 male math 89
lisibao 1989 male math 99
xiaobao 1990 female chinese 78
------
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>AWK工作流程：<strong>逐行扫描文件，从第一行到最后一行，寻找匹配特定模式的行，并在这些行上进行用户想要到的操作</strong>。</p>
<p>BEGIN只会在最开始执行；END只会在扫描所有行数之后执行。BEGIN和END之间的花括号的内容每扫描一行都会执行。</p>
<p>4)查找女生的成绩且只输出姓名、学科、成绩：</p>
<pre class="line-numbers language-shell"><code class="language-shell">$ awk '$3=="female"`{print $1,$4,$5}`' s.txt
wanglijiang chinese 78
xuxin english 99
wanglijiang chinese 78
xiaobao chinese 78
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>$1</code>表示第1列，<code>$n</code>类推。这里条件是表达式，而不是正则。print里<code>,</code>表示空格分隔符。</p>
<p>5)找出1990年出生的学生姓名，并要求匹配正则:</p>
<pre class="line-numbers language-shell"><code class="language-shell">$ awk '$2~/1990/`{print $1}`' s.txt
wanglijiang
wanglijiang
xiaobao<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里<code>~</code>表示匹配正则表达式。<code>!~</code>表示不匹配正则表达式。</p>
<p>如果需要多选，则改成：</p>
<pre class="line-numbers language-shell"><code class="language-shell">$ awk '$2~/(1990|1991)/`{print $1}`' s.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>参考: <a target="_blank" rel="noopener" href="https://github.com/52fhy/shell-book">https://github.com/52fhy/shell-book</a></p>

            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">布莱恩特科比酱</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://jaav.com.cn/posts/1b2.html">https://jaav.com.cn/posts/1b2.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">布莱恩特科比酱</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Shell/">
                                    <span class="chip bg-color">Shell</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("/medias/comment_bg.webp") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<script>
    let metaPlaceholder = {"nick":"昵称/QQ号(必填)","mail":"邮箱(必填)","link":"网址(https://)"};
    //这里要换行
    new Valine({
        el: '#vcomments',
        appId: 'jednIfOezaTYEzdCMCHUaToe-MdYXbMMI',
        appKey: 's07Yisjp8amNBBQzRFSa6tIF',
        notify: 'true' === 'true',
        verify: 'true' === 'true',
        visitor: 'true' === 'true',
        avatar: 'monsterid',
        pageSize: '10',
        lang: 'zh-CN',
        placeholder: 'ヾﾉ≧∀≦)o来啊，快活啊!',
        meta: ["nick", "mail", "link"],
        recordIP: 'true' === 'true',
        enableQQ: 'monsterid',
        requiredFields: ["884dfd2bde4d1a57adc962d0d3e6b2a5"],
        master: ["884dfd2bde4d1a57adc962d0d3e6b2a5"],
        friends: ["884dfd2bde4d1a57adc962d0d3e6b2a5", "901345d4c91ddfd8db0f175bbcfff0c8", "1512958e18378c98b498d5effe3e76ff"],
        tagMeta: ["博主", "小伙伴", "访客"],
        metaPlaceholder: metaPlaceholder,
    });
</script>

    

    <!--畅言云评-->
    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/posts/502d.html">
                    <div class="card-image">
                        
                        <img src="https://matery.oss-cn-hangzhou.aliyuncs.com/pic/featureImages/9.jpg" class="responsive-img" alt="spring之ioc容器">
                        
                        <span class="card-title">spring之ioc容器</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            spring的ioc容器以及依赖注入
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2020-08-16
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Java/" class="post-category">
                                    Java
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Spring/">
                        <span class="chip bg-color">Spring</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/posts/5de7.html">
                    <div class="card-image">
                        
                        <img src="https://matery.oss-cn-hangzhou.aliyuncs.com/pic/featureImages/7.jpg" class="responsive-img" alt="nginx配置https">
                        
                        <span class="card-title">nginx配置https</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            博客配置https访问
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-08-06
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E8%BD%AF%E4%BB%B6/" class="post-category">
                                    软件
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/nginx/">
                        <span class="chip bg-color">nginx</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2021</span>
            
            <a href="/about" target="_blank">布莱恩特科比酱</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">34.2k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/axh2018" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:a1759895304@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
